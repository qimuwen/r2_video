<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è§†é¢‘æ’­æ”¾å™¨</title>
    <link rel="stylesheet" href="style.css">
</head>
<body class="player-page">
    <div class="player-container">
        <div class="player-header">
            <button class="back-btn" onclick="history.back()">â† è¿”å›</button>
            <h2 id="videoTitle">åŠ è½½ä¸­...</h2>
        </div>

        <div class="player-wrapper">
            <video id="videoPlayer" controls autoplay>
                æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒ HTML5 è§†é¢‘æ’­æ”¾ã€‚
            </video>
        </div>

        <div class="player-info">
            <div class="info-section">
                <h3>ğŸ“Š è§†é¢‘ä¿¡æ¯</h3>
                <div class="info-grid">
                    <div class="info-item">
                        <span class="info-label">åˆ†è¾¨ç‡:</span>
                        <span class="info-value" id="resolution">æ£€æµ‹ä¸­...</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">æ—¶é•¿:</span>
                        <span class="info-value" id="duration">--:--</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">æ–‡ä»¶å¤§å°:</span>
                        <span class="info-value" id="fileSize">æ£€æµ‹ä¸­...</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">æ’­æ”¾çŠ¶æ€:</span>
                        <span class="info-value" id="playStatus">å‡†å¤‡ä¸­</span>
                    </div>
                </div>
            </div>

            <div class="controls-section">
                <h3>âš™ï¸ æ’­æ”¾æ§åˆ¶</h3>
                <div class="control-buttons">
                    <button onclick="changePlaybackRate(0.5)">0.5x</button>
                    <button onclick="changePlaybackRate(0.75)">0.75x</button>
                    <button onclick="changePlaybackRate(1.0)" class="active">1.0x</button>
                    <button onclick="changePlaybackRate(1.25)">1.25x</button>
                    <button onclick="changePlaybackRate(1.5)">1.5x</button>
                    <button onclick="changePlaybackRate(2.0)">2.0x</button>
                </div>

                <div class="control-buttons">
                    <button onclick="skipTime(-10)">âª -10s</button>
                    <button onclick="skipTime(-5)">âª -5s</button>
                    <button onclick="togglePlay()">â¯ï¸ æ’­æ”¾/æš‚åœ</button>
                    <button onclick="skipTime(5)">â© +5s</button>
                    <button onclick="skipTime(10)">â© +10s</button>
                </div>

                <div class="control-buttons">
                    <button onclick="toggleMute()">ğŸ”‡ é™éŸ³</button>
                    <button onclick="toggleFullscreen()">â›¶ å…¨å±</button>
                    <button onclick="downloadVideo()">ğŸ’¾ ä¸‹è½½</button>
                </div>
            </div>

            <div class="quality-section">
                <h3>ğŸ¨ ç”»è´¨é€‰æ‹©</h3>
                <div class="quality-buttons" id="qualityButtons">
                    <span style="color: #999; font-size: 14px;">å½“å‰ç‰ˆæœ¬ä»…æ”¯æŒåŸå§‹ç”»è´¨</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        const videoPlayer = document.getElementById('videoPlayer');
        const urlParams = new URLSearchParams(window.location.search);
        const videoUrl = urlParams.get('url');
        const videoTitle = urlParams.get('title') || 'æœªå‘½åè§†é¢‘';

        // è®¾ç½®æ ‡é¢˜
        document.getElementById('videoTitle').textContent = videoTitle;
        document.title = videoTitle;

        // æ£€æŸ¥ URL
        if (!videoUrl) {
            alert('é”™è¯¯ï¼šæœªæä¾›è§†é¢‘ URL');
            history.back();
        } else {
            videoPlayer.src = videoUrl;
        }

        // æ ¼å¼åŒ–æ—¶é—´
        function formatTime(seconds) {
            const h = Math.floor(seconds / 3600);
            const m = Math.floor((seconds % 3600) / 60);
            const s = Math.floor(seconds % 60);

            if (h > 0) {
                return `${h}:${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
            }
            return `${m}:${s.toString().padStart(2, '0')}`;
        }

        // æ ¼å¼åŒ–æ–‡ä»¶å¤§å°
        function formatSize(bytes) {
            if (bytes === 0) return 'æœªçŸ¥';
            const k = 1024;
            const sizes = ['B', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // è§†é¢‘åŠ è½½å…ƒæ•°æ®
        videoPlayer.addEventListener('loadedmetadata', () => {
            document.getElementById('duration').textContent = formatTime(videoPlayer.duration);
            document.getElementById('resolution').textContent = `${videoPlayer.videoWidth} x ${videoPlayer.videoHeight}`;
        });

        // è§†é¢‘å¼€å§‹æ’­æ”¾
        videoPlayer.addEventListener('play', () => {
            document.getElementById('playStatus').textContent = 'â–¶ï¸ æ’­æ”¾ä¸­';
        });

        // è§†é¢‘æš‚åœ
        videoPlayer.addEventListener('pause', () => {
            document.getElementById('playStatus').textContent = 'â¸ï¸ å·²æš‚åœ';
        });

        // è§†é¢‘ç»“æŸ
        videoPlayer.addEventListener('ended', () => {
            document.getElementById('playStatus').textContent = 'âœ… æ’­æ”¾å®Œæˆ';
        });

        // è·å–æ–‡ä»¶å¤§å°
        fetch(videoUrl, { method: 'HEAD' })
            .then(response => {
                const size = response.headers.get('Content-Length');
                if (size) {
                    document.getElementById('fileSize').textContent = formatSize(parseInt(size));
                }
            })
            .catch(() => {
                document.getElementById('fileSize').textContent = 'æœªçŸ¥';
            });

        // æ’­æ”¾æ§åˆ¶å‡½æ•°
        function changePlaybackRate(rate) {
            videoPlayer.playbackRate = rate;
            document.querySelectorAll('.control-buttons button').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
        }

        function skipTime(seconds) {
            videoPlayer.currentTime += seconds;
        }

        function togglePlay() {
            if (videoPlayer.paused) {
                videoPlayer.play();
            } else {
                videoPlayer.pause();
            }
        }

        function toggleMute() {
            videoPlayer.muted = !videoPlayer.muted;
        }

        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                videoPlayer.requestFullscreen();
            } else {
                document.exitFullscreen();
            }
        }

        function downloadVideo() {
            const a = document.createElement('a');
            a.href = videoUrl;
            a.download = videoTitle + '.mp4';
            a.click();
        }

        // é”®ç›˜å¿«æ·é”®
        document.addEventListener('keydown', (e) => {
            switch(e.key) {
                case ' ':
                    e.preventDefault();
                    togglePlay();
                    break;
                case 'ArrowLeft':
                    skipTime(-5);
                    break;
                case 'ArrowRight':
                    skipTime(5);
                    break;
                case 'f':
                    toggleFullscreen();
                    break;
                case 'm':
                    toggleMute();
                    break;
            }
        });
    </script>
</body>
</html>

